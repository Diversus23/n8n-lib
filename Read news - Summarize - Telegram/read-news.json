{
  "name": "–ü–æ–∏—Å–∫ –∏–¥–µ–π –¥–ª—è –±–ª–æ–≥–∞ –ö–æ–¥ –ò–¢-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 7,
              "triggerAtMinute": 30
            },
            {
              "field": "weeks",
              "triggerAtDay": [
                6,
                0
              ],
              "triggerAtHour": 9
            },
            {
              "triggerAtHour": 15
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -720,
        448
      ],
      "id": "5217d0e3-418e-4f2b-9f28-84ad1fa2670d",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "jsCode": "const rss = [\n  { name: \"Hacker News\", url: \"https://news.ycombinator.com/rss\", weight: 1.0 },\n  { name: \"Reddit Tech\", url: \"https://www.reddit.com/r/technology/hot/.rss\", weight: 1.0 },\n  { name: \"Habr\", url: \"https://habr.com/ru/rss/hubs/all/\", weight: 1.0 },\n  { name: \"Arc\", url: \"https://arstechnica.com/information-technology/feed/\", weight: 1.0},\n  { name: \"Hackernoon\", url: \"https://hackernoon.com/tagged/programming/feed\", weight: 1.0},\n  { name: \"TechCrunch\", url: \"https://techcrunch.com/feed/\", weight: 1.0},\n  { name: \"Reddit Self Hosted\", \"url\": \"https://www.reddit.com/r/selfhosted.rss\", weight: 1.2},\n  { name: \"Reddit SysAdmin\", url: \"https://www.reddit.com/r/sysadmin.rss\", weight: 0.95},\n  { name: \"Open source\", url: \"https://opensource.com/feed\", weight: 1.1},\n  { name: \"AI Trends\", url: \"https://www.aitrends.com/feed/\", weight: 1.0}\n];\n\nconst keywords = {\n  'positive': [\n  // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è ---\n  'it management', 'team management', 'leadership', 'hiring', 'recruitment', 'onboarding', 'tech debt', 'total cost of ownership', 'tco', 'it budget', 'sla', 'project management', 'agile', 'scrum', 'kanban', 'postmortem', 'case study', 'lessons learned', 'failure', 'it strategy',\n\n  // --- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ---\n  '1c', '1—Å', 'postgresql', 'mssql', 'database', 'sql', 'linux', 'server', 'virtualization', 'vmware', 'proxmox', 'docker', 'kubernetes', 'containerization', 'system architecture', 'system design', 'microservices', 'monolith', 'high availability', 'scalability', 'performance',\n\n  // --- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ---\n  'security', 'cybersecurity', 'infosec', 'vulnerability', 'data breach', 'compliance', 'backup', 'disaster recovery', 'pentest', 'firewall',\n\n  // --- DevOps –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è ---\n  'devops', 'ci/cd', 'automation', 'scripting', 'powershell', 'bash', 'python', 'api', 'ansible', 'terraform', 'infrastructure as code', 'iac',\n\n  // --- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –ü–û ---\n  'open source', 'open-source', 'self-hosted', 'monitoring', 'zabbix', 'prometheus', 'grafana', 'github', 'gitlab', 'tool', 'software',\n\n  // --- AI / ML (–ø—Ä–∏–∫–ª–∞–¥–Ω–æ–π –∞—Å–ø–µ–∫—Ç) ---\n  'ai', 'ml', 'machine learning', 'llm', 'openai', 'chatgpt', 'gemini', 'anthropic', 'openrouter', 'rag', 'fine-tuning'\n],\n  'negative': [\n  // --- –•–∞–π–ø –∏ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å—ã ---\n  'crypto', 'cryptocurrency', 'bitcoin', 'nft', 'blockchain', 'web3', 'metaverse', 'startup funding', 'venture capital', 'investment',\n\n  // --- –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ –ø—Ä–æ–¥–∞–∂–∏ ---\n  'marketing', 'sales', 'seo', 'growth hacking', 'e-commerce', 'influencer',\n\n  // --- –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å—Å–∫–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è ---\n  'gaming', 'game development', 'gamedev', 'console', 'playstation', 'xbox', 'iphone', 'android', 'gadget', 'review', 'wearable', 'smart home', 'film', 'movie', 'tv series', 'music', 'artwork', 'hollywood',\n\n  // --- –û–±—â–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –ø–æ–ª–∏—Ç–∏–∫–∞ ---\n  'politics', 'government', 'election', 'trump', 'biden',\n\n  // --- –£–∑–∫–æ—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–ª–∏ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ —Ç–µ–º—ã ---\n  'ocaml', 'haskell', 'lisp', 'erlang', 'quantum computing', 'research paper', 'academic',\n\n  // --- –ù–µ—Ü–µ–ª–µ–≤–æ–µ –ü–û –∏ —Ç–µ–º—ã ---\n  'driver', 'ffmpeg', 'medical', 'healthcare', 'biology', 'geographical', 'social media', 'Microsoft 365', 'Windows 11', 'dovecot', 'cloudflare',\n\n    // --- –Ω–∞ —Ä—É—Å—Å–∫–æ–º\n     '–∫–∞–∑–∏–Ω–æ', '–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã', '–±–∏—Ç–∫–æ–∏–Ω', '–∏–≥—Ä—ã', '–ø—Ä–æ–¥–∞–∂–∏', '–º–∞—Ä–∫–µ—Ç–∏–Ω–≥', '—Ñ–∏–ª—å–º', '–¥—Ä–∞–π–≤–µ—Ä', '—Ñ—å—é—á–µ—Ä—Å'\n]\n};\n\nconst incomingItems = $items();\nconst processedUrls = incomingItems.length > 0 ? incomingItems[0].json.processedUrls : [];\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —É–∑–ª–∞—Ö\nreturn [{\n  sources: rss,\n  filters: keywords,\n  processedUrls: processedUrls\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -112,
        448
      ],
      "id": "2609a194-f642-48b2-b2d6-f372b7f41d4a",
      "name": "Source List / Positive & Negative words"
    },
    {
      "parameters": {
        "fieldToSplitOut": "sources",
        "include": "allOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        112,
        352
      ],
      "id": "0a30ecbf-3e9a-4a62-bed1-524df7f8377f",
      "name": "Split Out"
    },
    {
      "parameters": {
        "jsCode": "// –ë–µ—Ä—ë–º negative –∏–∑ —É–∑–ª–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º \"Source List / Positive & Negative words\"\nconst negatives = ($('Source List / Positive & Negative words').first().json.filters.negative ?? []\n)\n  .map(s => String(s).trim().toLowerCase())\n  .filter(Boolean); // —É–±—Ä–∞—Ç—å –ø—É—Å—Ç—ã–µ\n\n// –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ–º RSS-—ç–ª–µ–º–µ–Ω—Ç—ã: –∏—Å–∫–ª—é—á–∞–µ–º, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ —Ö–æ—Ç—å –æ–¥–Ω–∞ \"–Ω–µ–≥–∞—Ç–∏–≤–∫–∞\"\nreturn $input.all().filter(item => {\n  const title = (item.json.title || '').toLowerCase();\n  const content = (item.json.content || item.json.contentSnippet || '').toLowerCase();\n  const haystack = `${title} ${content}`;\n\n  const hasNegative = negatives.some(word => haystack.includes(word));\n  return !hasNegative; // –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ–≤\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        784,
        224
      ],
      "id": "b391abaa-ca3a-4cf5-8c77-17e8bc13b25d",
      "name": "Remove negative news"
    },
    {
      "parameters": {
        "jsCode": "// --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---\n// –ü–æ—Ä–æ–≥ —Å—Ö–æ–∂–µ—Å—Ç–∏ (0.85 = 85%). –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ—Ö–æ–∂–∏ –Ω–∞ 85% –∏–ª–∏ –±–æ–ª—å—à–µ, –æ–Ω–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –¥—É–±–ª—è–º–∏.\n// –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω—è—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0.0 –¥–æ 1.0 –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.\nconst SIMILARITY_THRESHOLD = 0.8;\n\n// --- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å) ---\n\n/**\n * –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫: –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –Ω–µ-–±—É–∫–≤—ã –∏ –Ω–µ-—Ü–∏—Ñ—Ä—ã.\n * @param {string} title - –ò—Å—Ö–æ–¥–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.\n * @returns {string} - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫.\n */\nfunction normalizeTitle(title) {\n  if (!title || typeof title !== 'string') {\n    return '';\n  }\n  return title.toLowerCase().replace(/[\\W_]/g, '');\n}\n\n/**\n * –í—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –º–µ–∂–¥—É –¥–≤—É–º—è —Å—Ç—Ä–æ–∫–∞–º–∏.\n * @param {string} s1 - –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞.\n * @param {string} s2 - –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞.\n * @returns {number} - –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞.\n */\nfunction levenshteinDistance(s1, s2) {\n  const track = Array(s2.length + 1).fill(null).map(() => Array(s1.length + 1).fill(null));\n  for (let i = 0; i <= s1.length; i += 1) {\n    track[0][i] = i;\n  }\n  for (let j = 0; j <= s2.length; j += 1) {\n    track[j][0] = j;\n  }\n  for (let j = 1; j <= s2.length; j += 1) {\n    for (let i = 1; i <= s1.length; i += 1) {\n      const indicator = s1[i - 1] === s2[j - 1] ? 0 : 1;\n      track[j][i] = Math.min(\n        track[j][i - 1] + 1, // deletion\n        track[j - 1][i] + 1, // insertion\n        track[j - 1][i - 1] + indicator, // substitution\n      );\n    }\n  }\n  return track[s2.length][s1.length];\n}\n\n/**\n * –í—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–≤—É—Ö —Å—Ç—Ä–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞.\n * @param {string} s1 - –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞.\n * @param {string} s2 - –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞.\n * @returns {number} - –°—Ö–æ–∂–µ—Å—Ç—å –æ—Ç 0.0 –¥–æ 1.0.\n */\nfunction calculateSimilarity(s1, s2) {\n  if (!s1 || !s2) return 0;\n  const maxLength = Math.max(s1.length, s2.length);\n  if (maxLength === 0) return 1;\n  const distance = levenshteinDistance(s1, s2);\n  return (maxLength - distance) / maxLength;\n}\n\n\n// --- –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê ---\n\n// –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã (—Å—Ç–∞—Ç—å–∏)\nconst items = $input.all();\n\nconst uniqueArticles = [];\n\n// –¶–∏–∫–ª –ø–æ –≤—Å–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–º —Å—Ç–∞—Ç—å—è–º\nfor (const currentItem of items) {\n  let isDuplicate = false;\n  // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–µ–∂–¥–µ —á–µ–º –µ–≥–æ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å\n  const currentTitle = currentItem.json.title ? normalizeTitle(currentItem.json.title) : '';\n\n  // –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç–∞—Ç—å—é —Å–æ –≤—Å–µ–º–∏, —á—Ç–æ –º—ã —É–∂–µ –¥–æ–±–∞–≤–∏–ª–∏ –≤ —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö\n  for (const uniqueArticle of uniqueArticles) {\n    const uniqueTitle = uniqueArticle.json.normalizedTitle || normalizeTitle(uniqueArticle.json.title);\n    const similarity = calculateSimilarity(currentTitle, uniqueTitle);\n\n    if (similarity >= SIMILARITY_THRESHOLD) {\n      isDuplicate = true;\n      break; // –ù–∞—à–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç, –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–∞–ª—å—à–µ\n    }\n  }\n\n  // –ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –¥—É–±–ª–∏–∫–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –¥–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç—å—é –≤ —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö\n  if (!isDuplicate) {\n    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, —á—Ç–æ–±—ã –Ω–µ –≤—ã—á–∏—Å–ª—è—Ç—å –µ–≥–æ —Å–Ω–æ–≤–∞\n    currentItem.json.normalizedTitle = currentTitle;\n    uniqueArticles.push(currentItem);\n  }\n}\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π. n8n –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\n// —Å–æ–∑–¥–∞—Å—Ç –∏–∑ —ç—Ç–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –ø–æ—Ç–æ–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —É–∑–ª–æ–≤.\nreturn uniqueArticles;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1056,
        224
      ],
      "id": "23b183e1-eec6-473e-9dea-5fd1380a15db",
      "name": "Normalize"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        736,
        656
      ],
      "id": "f6bb8656-98a0-4b37-9b8f-935823c19df8",
      "name": "Merge"
    },
    {
      "parameters": {
        "jsCode": "const configNode = $items('Source List / Positive & Negative words')[0];\n\n// –ë–µ—Ä—ë–º negative-—Å–ª–æ–≤–∞, –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ —É–±–∏—Ä–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏.\nconst negatives = (configNode.json.filters.negative ?? [])\n  .map(s => String(s).trim().toLowerCase())\n  .filter(Boolean);\n\n// –ë–µ—Ä—ë–º –º–∞—Å—Å–∏–≤ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö URL.\nconst processedUrls = new Set(configNode.json.processedUrls ?? []);\n\n// –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ–º RSS-—ç–ª–µ–º–µ–Ω—Ç—ã: –∏—Å–∫–ª—é—á–∞–µ–º, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ —Ö–æ—Ç—å –æ–¥–Ω–∞ \"–Ω–µ–≥–∞—Ç–∏–≤–∫–∞\"\nreturn $input.all().filter(item => {\n  const title = (item.json.title || '').toLowerCase();\n  const content = (item.json.content || item.json.contentSnippet || '').toLowerCase();\n  const haystack = `${title} ${content}`;\n\n  const hasNegative = negatives.some(word => haystack.includes(word));\n\n  // --- –ü–†–û–í–ï–†–ö–ê 2: –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤ —Å–ø–∏—Å–∫–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö ---\n  const link = item.json.link || '';\n  const isAlreadyProcessed = processedUrls.has(link);\n  \n  // --- –ò–¢–û–ì–û–í–û–ï –†–ï–®–ï–ù–ò–ï ---\n  // –°—Ç–∞—Ç—å—è –æ—Å—Ç–∞–µ—Ç—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –Ω–µ–π –ù–ï–¢ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Å–ª–æ–≤ –ò –æ–Ω–∞ –ù–ï –±—ã–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ —Ä–∞–Ω–µ–µ.\n  return !hasNegative && !isAlreadyProcessed;\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        224
      ],
      "id": "1b48d7c4-2f71-400a-931f-535d5bb8c823",
      "name": "Remove in DB"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "YOUR_NOTION_DATABASE_ID",
          "mode": "list",
          "cachedResultName": "–ù–æ–≤–æ—Å—Ç–∏",
          "cachedResultUrl": "https://www.notion.so/24f4d557d3b18059ad55f6da4b12e773"
        },
        "returnAll": true,
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        -512,
        448
      ],
      "id": "e5a13606-3e83-4f9c-9720-4fb9eed83515",
      "name": "Get old links",
      "alwaysOutputData": true,
      "credentials": {
        "notionApi": {
          "id": "rA4TzoO1vPiM2yaC",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å $items()\nconst items = $items();\n\n// –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º –∏–∑ Notion.\n// –ó–ê–ú–ï–ù–ò–¢–ï 'Link' –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –∫–æ–ª–æ–Ω–∫–∏ —Å URL-–∞–¥—Ä–µ—Å–æ–º.\nconst names = items.map(item => \n  item.json.name\n).filter(name => name); // –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ–º –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è\n\n// –°–æ–∑–¥–∞—ë–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –°–†–ê–ó–£ –ñ–ï –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ –º–∞—Å—Å–∏–≤\nconst processedUrls = [...new Set(names)];\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –ú–ê–°–°–ò–í —Å—Å—ã–ª–æ–∫\nreturn [{ json: { processedUrls: processedUrls } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -304,
        448
      ],
      "id": "54e9738d-775a-4183-bac0-4899fcb7ffe7",
      "name": "Save old links",
      "executeOnce": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢—ã ‚Äî –ø—Ä–∞–≥–º–∞—Ç–∏—á–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ò–¢-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –∏–∑ –†–æ—Å—Å–∏–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–æ–º–æ—á—å –µ–º—É –æ—Ç–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –±–ª–æ–≥–∞ \"–ö–æ–¥ –ò–¢-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞\", –æ—Ü–µ–Ω–∏–≤ —Å—Ç–∞—Ç—å—é –ø–æ —à–∫–∞–ª–µ –æ—Ç 0 –¥–æ 100.\n\n–ê—É–¥–∏—Ç–æ—Ä–∏—è –±–ª–æ–≥–∞: –ò–¢-—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏, —Ç–∏–º–ª–∏–¥—ã, —Å–∏—Å–∞–¥–º–∏–Ω—ã –≤ –†–§.\n–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ª—å–∑–∞ > —Ö–∞–π–ø. –†–µ–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç > —Ç–µ–æ—Ä–∏—è.\n\n–ö–†–ò–¢–ï–†–ò–ò –û–¶–ï–ù–ö–ò\n\n* 90-100 (–ó–æ–ª–æ—Ç–æ): –ù–æ–≤–æ—Å—Ç—å –æ –Ω–æ–≤–æ–º –ø–æ–ª–µ–∑–Ω–æ–º open-source –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–µ–π—Å–∞ –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é —Å–ª–æ–∂–Ω–æ–π IT-–ø—Ä–æ–±–ª–µ–º—ã.\n* 70-89 (–°–µ—Ä–µ–±—Ä–æ): –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ–≥–æ IT-—Å–æ–±—ã—Ç–∏—è –∏ –µ–≥–æ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ –≤ –†–§. –û–±–∑–æ—Ä –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –∏–ª–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏.\n* 40-69 (–ë—Ä–æ–Ω–∑–∞): –ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è, –Ω–æ –Ω–µ —Å–ª–∏—à–∫–æ–º –≥–ª—É–±–æ–∫–∞—è –Ω–æ–≤–æ—Å—Ç—å –∏–∑ –º–∏—Ä–∞ IT. –û–±–∑–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±–µ–∑ —è–≤–Ω–æ–≥–æ –∫–µ–π—Å–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.\n* 10-39 (–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å): –û–±—â–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è. –ù–æ–≤–æ—Å—Ç–∏, –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø–∞–¥–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞.\n* 0 (–ú—É—Å–æ—Ä): –°—Ç–∞—Ç—å–∏ –æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞—Ö, –∏–≥—Ä–∞—Ö, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–µ, \"—É—Å–ø–µ—à–Ω–æ–º —É—Å–ø–µ—Ö–µ\", –ø–æ–ª–∏—Ç–∏–∫–µ.\n\n–ó–ê–î–ê–ß–ê\n–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π title –∏ content.\nid: {{ $json.link }}\ntitle: {{ $json.title }}\ncontent: {{ $json.content }}\n–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê:\n–í–µ—Ä–Ω–∏ –æ—Ç–≤–µ—Ç –°–¢–†–û–ì–û –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON-–æ–±—ä–µ–∫—Ç—Å –∫–ª—é—á–∞–º–∏:\n1. `id`: id\n3. `title`: title –Ω–∞ —Ä—É—Å—Å–∫–æ–º\n4. `ai_score`: —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 100.\n5. `reason`: –∫–æ—Ä–æ—Ç–∫–æ–µ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) –∏ —á–µ—Å—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ, –ø–æ—á–µ–º—É –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Ç–∞–∫–∞—è –æ—Ü–µ–Ω–∫–∞, —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑—ã –¥–ª—è –ò–¢-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º.\n\nExample:\n{\n  \"id\": \"https://site.com/pg/\",\n  \"ai_score\": 95,\n  \"title\": \"–ù–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Postgres\",\n  \"reason\": \"–≠—Ç–æ –Ω–æ–≤–æ—Å—Ç—å –æ –Ω–æ–≤–æ–º open-source –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ PostgreSQL, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫ —Ä–∞–∑–±–æ—Ä—É.\"\n}",
        "batching": {
          "batchSize": 50,
          "delayBetweenBatches": 1000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        1680,
        656
      ],
      "id": "737309a5-2f1a-49ad-9a0d-bca875c74889",
      "name": "Basic LLM Chain"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "gpt-4.1-nano"
        },
        "options": {
          "responseFormat": "json_object"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1680,
        848
      ],
      "id": "9c18542b-b6f3-4d2f-9dd5-f0c82f4eafe5",
      "name": "OpenAI Chat Model",
      "notesInFlow": false,
      "credentials": {
        "openAiApi": {
          "id": "sU9fsLymeiocBC6r",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "maxItems": 30
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        2416,
        656
      ],
      "id": "8a07d686-84e8-42c5-a4cf-39cb98788a4a",
      "name": "Limit 20"
    },
    {
      "parameters": {
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "ai_score",
              "order": "descending"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.sort",
      "typeVersion": 1,
      "position": [
        2240,
        656
      ],
      "id": "62cf2736-f258-4887-8ce7-19b399b77e81",
      "name": "Sort ai_score"
    },
    {
      "parameters": {
        "maxItems": 300
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        1408,
        656
      ],
      "id": "3fe12ca5-4f41-49fc-82e0-a0e2a05c3a9b",
      "name": "Limit 300"
    },
    {
      "parameters": {
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "score",
              "order": "descending"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.sort",
      "typeVersion": 1,
      "position": [
        1200,
        656
      ],
      "id": "5bcf9c14-acc1-47ec-9d5f-6e43770f064d",
      "name": "Sort score"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---\n// –ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–∞—Ç—å–∏\nconst BASE_SCORE = 10;\n// –°–∫–æ–ª—å–∫–æ –±–∞–ª–ª–æ–≤ –¥–æ–±–∞–≤–ª—è—Ç—å –∑–∞ –∫–∞–∂–¥–æ–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –ø–æ–∑–∏—Ç–∏–≤–Ω–æ–µ —Å–ª–æ–≤–æ\nconst POSITIVE_KEYWORD_BONUS = 5;\nconst COMMENT_BONUS_PER_COMMENT = 0.5; // –ë–∞–ª–ª–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π\nconst MAX_COMMENT_BONUS = 25;          // –ù–æ –Ω–µ –±–æ–ª–µ–µ —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è\n\n// --- –õ–û–ì–ò–ö–ê ---\n\n// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç–∞—Ç—å—é\nconst item = $input.item.json;\n\n// 1. –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–π —Ä–µ–π—Ç–∏–Ω–≥\nlet score = BASE_SCORE;\n\n// 2. –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ –≤–µ—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å\nif (item.weight) {\n  score *= item.weight;\n}\n\n// 3. –ò—â–µ–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ –Ω–∞—á–∏—Å–ª—è–µ–º –±–æ–Ω—É—Å—ã\nconst positiveKeywords = item.filters.positive || [];\n\n// –°–æ–±–∏—Ä–∞–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É\nconst textToSearch = (\n  (item.title || '') + ' ' + \n  (item.content || '') + ' ' + \n  (item.contentSnippet || '')\n).toLowerCase();\n\n// –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É\nfor (const keyword of positiveKeywords) {\n  // –ï—Å–ª–∏ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ, –¥–æ–±–∞–≤–ª—è–µ–º –±–æ–Ω—É—Å\n  if (textToSearch.includes(keyword.toLowerCase())) {\n    score += POSITIVE_KEYWORD_BONUS;\n  }\n}\n\n// 4. –ù–û–í–´–ô –ë–õ–û–ö: –î–æ–±–∞–≤–ª—è–µ–º –±–∞–ª–ª—ã –∑–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏\nconst commentCount = item.comment_count || 0;\nconst commentBonus = Math.min(commentCount * COMMENT_BONUS_PER_COMMENT, MAX_COMMENT_BONUS);\nscore += commentBonus;\n\n// –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –≤ —Å–∞–º—É —Å—Ç–∞—Ç—å—é\nitem.score = score;\n\n// –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é —Å—Ç–∞—Ç—å—é\nreturn item;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        992,
        656
      ],
      "id": "13163ee6-afd4-4fa4-9890-f01bcdb08e20",
      "name": "Positive score"
    },
    {
      "parameters": {
        "jsCode": "function escapeHtml(s) {\n  return String(s ?? '')\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;');\n}\n\nfunction escapeAttrUrl(url) {\n  return encodeURI(String(url ?? '')).replace(/\"/g, '&quot;');\n}\n\nconst items = $items();\n\nconst header = '<b>üî• –¢–æ–ø IT-–Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:</b>\\n\\n';\n\nconst lines = items.map((item, index) => {\n  const title = escapeHtml(item.json.title);\n  const link = escapeAttrUrl(item.json.id);\n  const score = Math.round(item.json.ai_score || 0);\n  const reason = escapeHtml(item.json.reason);\n\n  return `${index + 1}. <i>[${score}/100]</i> <a href=\"${link}\">${title}</a> ‚Äî ${reason}`;\n});\n\nconst MAX = 3500;\nconst messages = [];\nlet buf = header;\n\nfor (const line of lines) {\n  if ((buf + '\\n' + line).length > MAX) {\n    messages.push(buf.trim());\n    buf = '';\n  }\n  buf += (buf ? '\\n' : '') + line;\n}\nif (buf) messages.push(buf.trim());\n\nreturn messages.map(html => ({ json: { telegram_message: html } }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2624,
        656
      ],
      "id": "c6462183-9f25-4499-8d43-0b561fe5dbee",
      "name": "Summarize",
      "executeOnce": true
    },
    {
      "parameters": {
        "chatId": "YOUR_TELEGRAM_CHAT_ID",
        "text": "={{ $json.telegram_message }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2816,
        656
      ],
      "id": "e7a20cba-97c6-4703-8ddf-c68082f7a998",
      "name": "Send a text message",
      "webhookId": "d3b12fe1-f6fb-465b-a455-4490bb5da89a",
      "credentials": {
        "telegramApi": {
          "id": "6DvFEw6JJb9HJu3i",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "YOUR_NOTION_DATABASE_ID",
          "mode": "list",
          "cachedResultName": "–ù–æ–≤–æ—Å—Ç–∏",
          "cachedResultUrl": "https://www.notion.so/24f4d557d3b18059ad55f6da4b12e773"
        },
        "title": "={{ $json.id }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Date|rich_text",
              "textContent": "={{ $now.format('yyyy-MM-dd') }}"
            },
            {
              "key": "Number|number",
              "numberValue": "={{ $json.ai_score }}"
            },
            {
              "key": "Text|rich_text",
              "textContent": "={{ $json.reason }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        2048,
        848
      ],
      "id": "5538034f-faa1-43bc-9fe7-2af63c81221b",
      "name": "Save new links",
      "credentials": {
        "notionApi": {
          "id": "rA4TzoO1vPiM2yaC",
          "name": "Notion account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "url": "={{ $json.sources.url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        304,
        352
      ],
      "id": "6b37754b-9d65-4dbd-9a58-e8e208b5d347",
      "name": "Read RSS",
      "retryOnFail": true,
      "notesInFlow": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// ====== –ù–ê–°–¢–†–û–ô–ö–ò ======\nconst DELAY_MS = 200;           // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ DDoS-–∏—Ç—å\nconst MAX_URLS_PER_ITEM = 20;   // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ —Å—Å—ã–ª–æ–∫ –Ω–∞ item\nconst TIMEOUT_MS = 15000;\n\n// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã\nconst COMMENT_REGEXES = [\n  {name: 'en-comments', rx: /(\\d+)\\s*(?:&nbsp;|&#160;|&#xA0;|\\s)*(?:comment|comments)\\b/i},\n  {name: 'ru-kommentarii', rx: /(\\d+)\\s*(?:&nbsp;|&#160;|&#xA0;|\\s)*(?:–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤|–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è|–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)\\b/i},\n  {name: 'class-comment-count', rx: /comment-?count[^>]*>\\s*(\\d+)/i},\n  {name: 'data-comment-count', rx: /data-comment-count=[\"']?(\\d+)/i},\n  {name: 'meta-commentCount', rx: /itemprop=[\"']commentCount[\"'][^>]*content=[\"'](\\d+)[\"']/i},\n  {name: 'aria-label-comments', rx: /aria-label=[\"'][^\"']*?(\\d+)\\s*(?:comment|comments)\\b/i},\n  {name: 'num-comments', rx: /\"num-comments\"[^>]*>\\s*(\\d+)/i},\n  // HN —è–∫–æ—Ä–Ω–∞—è –ø–æ–¥—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞\n  {name: 'hn-anchor', rx: /<a[^>]*href=\"item\\?id=\\d+\"[^>]*>\\s*(\\d+)\\s*(?:&nbsp;|&#160;|&#xA0;|\\s)*comments/i},\n];\n\n// ====== –•–ï–õ–ü–ï–†–´ ======\nfunction sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }\n\nfunction extractUrlsFromString(s) {\n  const urls = [];\n  if (!s || typeof s !== 'string') return urls;\n\n  // –ü—Ä—è–º—ã–µ URL\n  const urlLike = /(https?:\\/\\/[^\\s\"'<>]+)/gi;\n  let m;\n  while ((m = urlLike.exec(s)) !== null) urls.push(m[1]);\n\n  // href=\"...\" –∏ href='...'\n  const hrefDq = /href\\s*=\\s*\"(.*?)\"/gi;\n  while ((m = hrefDq.exec(s)) !== null) if (m[1]) urls.push(m[1]);\n  const hrefSq = /href\\s*=\\s*'(.*?)'/gi;\n  while ((m = hrefSq.exec(s)) !== null) if (m[1]) urls.push(m[1]);\n\n  return urls;\n}\n\nfunction collectUrlsFromItem(item) {\n  const set = new Set();\n  const j = item.json || {};\n\n  // 1) –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Äî —è–≤–Ω–æ–µ –ø–æ–ª–µ comments\n  if (typeof j.comments === 'string' && /^https?:\\/\\//i.test(j.comments)) {\n    set.add(j.comments);\n  }\n\n  // 2) –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–æ–ª—è\n  for (const v of Object.values(j)) {\n    if (typeof v !== 'string') continue;\n    for (const u of extractUrlsFromString(v)) {\n      if (/^https?:\\/\\//i.test(u)) set.add(u);\n    }\n  }\n\n  return Array.from(set).slice(0, MAX_URLS_PER_ITEM);\n}\n\nasync function fetchHtml(url) {\n  try {\n    const res = await $httpClient.get(url, {\n      responseType: 'text',\n      timeout: TIMEOUT_MS,\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (n8n; bot)',\n        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\n        'Accept-Language': 'en-US,en;q=0.9,ru;q=0.8',\n      },\n      maxRedirects: 5,\n      validateStatus: s => s >= 200 && s < 400,\n    });\n    return { html: String(res.data || ''), status: res.status };\n  } catch(e) {\n    return { html: null, status: e.response?.status || null, error: e.message };\n  }\n}\n\nfunction tryGeneric(html) {\n  if (!html) return { count: null, matched: null };\n  for (const {name, rx} of COMMENT_REGEXES) {\n    const m = html.match(rx);\n    if (m && m[1]) {\n      const n = parseInt(m[1], 10);\n      if (Number.isFinite(n)) return { count: n, matched: name };\n    }\n  }\n  // HN \"discuss\" => 0 –∫–æ–º–º–µ–Ω—Ç–æ–≤\n  if (/> *discuss *</i.test(html)) return { count: 0, matched: 'hn-discuss-0' };\n  return { count: null, matched: null };\n}\n\nfunction isHN(url) {\n  try {\n    const u = new URL(url);\n    return u.hostname.endsWith('news.ycombinator.com') && u.pathname === '/item';\n  } catch { return false; }\n}\n\nfunction tryHackerNews(html) {\n  // –°–Ω–∞—á–∞–ª–∞ –æ–±—ã—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã\n  const g = tryGeneric(html);\n  if (g.count !== null) return g;\n\n  // –§–æ–ª–±—ç–∫: —Å—á–∏—Ç–∞–µ–º <tr class=\"comtr\">\n  const matches = html ? html.match(/<tr\\s+class=[\"']?comtr\\b/gi) : null;\n  if (matches) return { count: matches.length, matched: 'hn-comtr-count' };\n\n  return { count: null, matched: null };\n}\n\nasync function processItem(item) {\n  const j = item.json || {};\n  j.comment_count = j.comment_count || 0;\n\n  const urls = collectUrlsFromItem(item);\n  const debugUrls = [];\n  let lastStatus = null;\n  let matchedName = null;\n\n  for (const url of urls) {\n    debugUrls.push(url);\n\n    const { html, status } = await fetchHtml(url);\n    lastStatus = status ?? lastStatus;\n\n    let res;\n    if (isHN(url)) {\n      res = tryHackerNews(html);\n    } else {\n      res = tryGeneric(html);\n    }\n\n    if (Number.isInteger(res.count)) {\n      j.comment_count = res.count;\n      j.comment_url_detected = url;\n      matchedName = res.matched;\n      break;\n    }\n\n    await sleep(DELAY_MS);\n  }\n\n  // –í—Å–µ–≥–¥–∞ –ø–∏—à–µ–º –æ—Ç–ª–∞–¥–∫—É, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏\n  j._debug_checked_urls = debugUrls;\n  if (lastStatus !== null) j._debug_last_status = lastStatus;\n  if (matchedName) j._debug_matched_regex = matchedName;\n\n  item.json = j;\n  return item;\n}\n\n// ====== –û–°–ù–û–í–ê ======\nconst items = $items();\nconst out = [];\nfor (const it of items) {\n  out.push(await processItem(it));\n}\nreturn out;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1296,
        224
      ],
      "id": "7ea4a159-838f-4a47-8444-f533c2819a41",
      "name": "Code"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e0febce2-ce27-4bb4-a6e5-16ebcfe6bd2f",
              "leftValue": "={{ $json.ai_score }}",
              "rightValue": 40,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        2032,
        656
      ],
      "id": "d81e2cda-a8db-4c3e-be8f-4ff31d3ba225",
      "name": "Filter ai_score >= 40"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Get old links",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Source List / Positive & Negative words": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Read RSS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove negative news": {
      "main": [
        [
          {
            "node": "Normalize",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Normalize": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Positive score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove in DB": {
      "main": [
        [
          {
            "node": "Remove negative news",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get old links": {
      "main": [
        [
          {
            "node": "Save old links",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save old links": {
      "main": [
        [
          {
            "node": "Source List / Positive & Negative words",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "Filter ai_score >= 40",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save new links",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit 20": {
      "main": [
        [
          {
            "node": "Summarize",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort ai_score": {
      "main": [
        [
          {
            "node": "Limit 20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit 300": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort score": {
      "main": [
        [
          {
            "node": "Limit 300",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Positive score": {
      "main": [
        [
          {
            "node": "Sort score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summarize": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read RSS": {
      "main": [
        [
          {
            "node": "Remove in DB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter ai_score >= 40": {
      "main": [
        [
          {
            "node": "Sort ai_score",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save new links": {
      "main": [
        []
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "timezone": "Europe/Moscow",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "0e1a0502-1b23-437c-a7ae-713ff62e160b",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "7385df13da89f7577631509cd419d14c671f1f37554b01bff11c864db38521f8"
  },
  "id": "BbQSON2jZqqhjJkV",
  "tags": []
}